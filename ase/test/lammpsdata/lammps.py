#!/usr/bin/env python

import ase.io
import StringIO

at = ase.io.read("example.lammps-data")

expected_output = [line.strip() for line in """8
Lattice="102.3776 0.0 0.0 0.0 102.3776 0.0 0.0 0.0 102.3776" Properties=species:S:1:pos:R:3:bonds:S:1:masses:R:1:mol-id:I:1:Z:I:1:angles:S:1:momenta:R:3:type:I:1:id:I:1:travel:I:3 comment="LAMMPS data file via write_data, version 7 Sep 2016, timestep = 1000000" pbc="T T T"
H     -7.06540129      -0.47737244     -51.10245267 1(1)     56.00000000        1        1 _     -0.71750717      -0.10137357       0.49670793        1        1        2       -1        6
H     -8.12378444      -1.33406959      47.65830228 2(1)     56.00000000        1        1 0-2(1)      0.43169222      -0.03144355       0.76421658        1        2        2       -1        5
H    -12.09052522      -3.23153540      47.36343710 3(1)     56.00000000        1        1 1-3(1)     -0.19671990       0.06926505       0.54577652        1        3        2       -1        5
H     -8.32722450      -4.84131620      45.60905541 _     56.00000000        1        1 _      0.65105933      -0.00066880       0.49002935        1        4        2       -1        5
H     -5.38796182      49.52463522      30.05486271 5(1)     56.00000000        2        1 _      0.61339605      -0.93578366       0.12500441        1        5        6       -7       -2
H     -8.49500759     -49.36329713      32.58892582 6(1)     56.00000000        2        1 4-6(1)      0.21008736       0.78913568       0.40859793        1        6        6       -6       -2
H     -9.75442821      49.86975598      36.36228789 7(1)     56.00000000        2        1 5-7(1)      0.30214219      -0.45927680       1.12893813        1        7        6       -7       -2
H     -5.57124378      47.66022553      38.84723587 _     56.00000000        2        1 _      0.42041445       0.33263157       0.40961149        1        8        6       -7       -2
""".split("\n")]

buf = StringIO.StringIO()
ase.io.write(buf, at, format="extxyz")
lines = [line.strip() for line in buf.getvalue().split("\n")]

assert lines == expected_output
