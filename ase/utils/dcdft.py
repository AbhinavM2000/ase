def delta(v1, B1, Bp1, v2, B2, Bp2):
    c1 = B1 / (2 * v1)
    d1 = -(1 + Bp1) * B1 / (6 * v1**2)
    c2 = B2 / (2 * v2)
    d2 = -(2 + Bp2) * B2 / (6 * v2**2)
    if 0:
        va = 0.94 * (v1 + v2) / 2
        vb = 1.06 * (v1 + v2) / 2
    else:
        va = 0.94 * v2
        vb = 1.06 * v2
    Ia = f(va, c1, d1, v1, c2, d2, v2)
    Ib = f(vb, c1, d1, v1, c2, d2, v2)
    dv = 0.12 * (vb - va)
    return ((Ib - Ia) / dv)**0.5


def f(v, c1, d1, v1, c2, d2, v2):
    r = v * (
        c1**2 * v1**4 - 2 * c1 * c2 * v1**2 * v2**2 - 2 * c1 * d1 * v1**5 + 2 *
        c1 * d2 * v1**2 * v2**3 + c2**2 * v2**4 + 2 * c2 * d1 * v1**3 * v2**2 -
        2 * c2 * d2 * v2**5 + d1**2 * v1**6 - 2 * d1 * d2 * v1**3 * v2**3 +
        d2**2 * v2**6 + v**6 * (d1**2 - 2 * d1 * d2 + d2**2) / 7 + v**5 *
        (c1 * d1 - c1 * d2 - c2 * d1 + c2 * d2 - 3 * d1**2 * v1 +
         3 * d1 * d2 * v1 + 3 * d1 * d2 * v2 - 3 * d2**2 * v2) / 3 + v**4 *
        (c1**2 - 2 * c1 * c2 - 10 * c1 * d1 * v1 + 4 * c1 * d2 * v1 + 6 * c1 *
         d2 * v2 + c2**2 + 6 * c2 * d1 * v1 + 4 * c2 * d1 * v2 - 10 * c2 * d2 *
         v2 + 15 * d1**2 * v1**2 - 6 * d1 * d2 * v1**2 - 18 * d1 * d2 * v1 * v2
         - 6 * d1 * d2 * v2**2 + 15 * d2**2 * v2**2) / 5 + v**3 *
        (-2 * c1**2 * v1 + 2 * c1 * c2 * v1 + 2 * c1 * c2 * v2 + 10 * c1 * d1 *
         v1**2 - c1 * d2 * v1**2 - 6 * c1 * d2 * v1 * v2 - 3 * c1 * d2 * v2**2
         - 2 * c2**2 * v2 - 3 * c2 * d1 * v1**2 - 6 * c2 * d1 * v1 * v2 -
         c2 * d1 * v2**2 + 10 * c2 * d2 * v2**2 - 10 * d1**2 * v1**3 +
         d1 * d2 * v1**3 + 9 * d1 * d2 * v1**2 * v2 + 9 * d1 * d2 * v1 * v2**2
         + d1 * d2 * v2**3 - 10 * d2**2 * v2**3) / 2 + v**2 *
        (6 * c1**2 * v1**2 - 2 * c1 * c2 * v1**2 - 8 * c1 * c2 * v1 * v2 -
         2 * c1 * c2 * v2**2 - 20 * c1 * d1 * v1**3 + 6 * c1 * d2 * v1**2 * v2
         + 12 * c1 * d2 * v1 * v2**2 + 2 * c1 * d2 * v2**3 + 6 * c2**2 * v2**2
         + 2 * c2 * d1 * v1**3 + 12 * c2 * d1 * v1**2 * v2 +
         6 * c2 * d1 * v1 * v2**2 - 20 * c2 * d2 * v2**3 + 15 * d1**2 * v1**4 -
         6 * d1 * d2 * v1**3 * v2 - 18 * d1 * d2 * v1**2 * v2**2 -
         6 * d1 * d2 * v1 * v2**3 + 15 * d2**2 * v2**4) / 3 + v *
        (-2 * c1**2 * v1**3 + 2 * c1 * c2 * v1**2 * v2 + 2 * c1 * c2 * v1 *
         v2**2 + 5 * c1 * d1 * v1**4 - 3 * c1 * d2 * v1**2 * v2**2 -
         2 * c1 * d2 * v1 * v2**3 - 2 * c2**2 * v2**3 -
         2 * c2 * d1 * v1**3 * v2 - 3 * c2 * d1 * v1**2 * v2**2 +
         5 * c2 * d2 * v2**4 - 3 * d1**2 * v1**5 + 3 * d1 * d2 * v1**3 * v2**2
         + 3 * d1 * d2 * v1**2 * v2**3 - 3 * d2**2 * v2**5))
    return r
